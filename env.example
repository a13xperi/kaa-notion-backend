# ============================================
# SAGE MVP Platform - Environment Variables
# ============================================
# Copy this file to .env and fill in your actual values
# Never commit .env to git!

# ============================================
# Database Configuration (Required for Prisma)
# ============================================
# Get from Supabase: Project Settings → Database → Connection string (URI)
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:5432/postgres

# ============================================
# Supabase Configuration (Postgres Database)
# ============================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your_supabase_anon_key_here
SUPABASE_SERVICE_KEY=your_supabase_service_role_key_here
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here

# Get these from: https://app.supabase.com/project/_/settings/api

# ============================================
# Database Connection
# ============================================
DATABASE_URL=postgresql://user:pass@localhost:5432/sage?schema=public

# ============================================
# Database Connection Pooling
# ============================================
# DATABASE_CONNECTION_LIMIT=10     # Max connections in pool
# DATABASE_CONNECTION_TIMEOUT=5000 # Connection timeout (ms)
# DATABASE_QUERY_TIMEOUT=10000     # Query timeout (ms)
# DATABASE_IDLE_TIMEOUT=60000      # Idle connection timeout (ms)
# SLOW_QUERY_THRESHOLD=1000        # Log queries slower than this (ms)

# ============================================
# Notion API Configuration (Display/Collaboration)
# ============================================
NOTION_API_KEY=ntn_your_integration_token_here
NOTION_PARENT_PAGE_ID=your_parent_page_id_for_databases

# Database IDs (optional - will auto-create if not set)
NOTION_PROJECTS_DATABASE_ID=
CLIENT_CREDENTIALS_DB_ID=
CLIENT_DOCUMENTS_DB_ID=
ACTIVITY_LOG_DB_ID=
CLIENT_ACTIVITIES_DB_ID=
CLIENTS_DB_ID=

# ============================================
# Stripe Configuration (Payments)
# ============================================
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_signing_secret_here

# Get these from: https://dashboard.stripe.com/apikeys
# Webhook secret from: https://dashboard.stripe.com/webhooks

# ============================================
# Email Configuration
# ============================================
# Option 1: Resend (Recommended for production)
# Get your API key from: https://resend.com/api-keys
RESEND_API_KEY=re_your_resend_api_key_here

# Option 2: SMTP (Nodemailer)
# Use with any SMTP provider (Gmail, SendGrid, Postmark, etc.)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-specific-password

# Email sender configuration
EMAIL_FROM=SAGE <hello@sage.design>
EMAIL_REPLY_TO=support@sage.design

# Team notification email
TEAM_EMAIL=team@kaa.com

# If neither RESEND_API_KEY nor SMTP_HOST is set, emails will be logged to console

# ============================================
# Application Configuration
# ============================================
NODE_ENV=development
PORT=3001
FRONTEND_URL=http://localhost:3000

# For production, set:
# NODE_ENV=production
# FRONTEND_URL=https://your-domain.com

# API Documentation (enabled in development, opt-in for production)
# ENABLE_API_DOCS=true

# ============================================
# Logging Configuration
# ============================================
# Log level: debug, info, warn, error (default: info)
LOG_LEVEL=info

# Log format: json (production default) or pretty (development default)
# LOG_FORMAT=json

# Service name for log aggregation
SERVICE_NAME=sage-api

# ============================================
# Security & CORS Configuration
# ============================================
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# For production:
# CORS_ORIGINS=https://sage.design,https://app.sage.design

# ============================================
# Error Tracking (Sentry)
# ============================================
# Get your DSN from: https://sentry.io
# SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx

# ============================================
# Slack Notifications
# ============================================
# Get webhook URL from: https://api.slack.com/apps
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx/xxx/xxx
# SLACK_DEFAULT_CHANNEL=#notifications
# SLACK_ENABLED=true

# ============================================
# Redis Cache (Optional)
# ============================================
# Production caching with Redis. Falls back to memory cache if not set.
# REDIS_URL=redis://localhost:6379
# CACHE_TTL=300            # Default TTL in seconds (5 minutes)
# CACHE_ENABLED=true

# ============================================
# Webhook Signing
# ============================================
# Secret for signing outgoing webhooks (HMAC-SHA256)
# WEBHOOK_SIGNING_SECRET=your-webhook-signing-secret

# Figma webhook validation (optional)
# FIGMA_WEBHOOK_PASSCODE=your-figma-passcode

# ============================================
# Frontend API Configuration
# ============================================
# React app API URL (must include /api suffix)
REACT_APP_API_URL=http://localhost:3001/api
REACT_APP_WS_URL=ws://localhost:3002
REACT_APP_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here
REACT_APP_VERSION=1.0.0

# For production:
# REACT_APP_API_URL=https://your-api-domain.com/api

# Optional: Frontend Stripe product/price configuration
# REACT_APP_STRIPE_TIER1_PRODUCT_ID=prod_...
# REACT_APP_STRIPE_TIER1_PRICE_ID=price_...
# REACT_APP_STRIPE_TIER2_PRODUCT_ID=prod_...
# REACT_APP_STRIPE_TIER2_PRICE_ID=price_...
# REACT_APP_STRIPE_TIER3_PRODUCT_ID=prod_...
# REACT_APP_STRIPE_TIER3_PRICE_ID=price_...
# REACT_APP_STRIPE_TIER3_DEPOSIT_PRICE_ID=price_...
# REACT_APP_STRIPE_TIER4_PRODUCT_ID=prod_...
# REACT_APP_STRIPE_TIER4_PRICE_ID=price_...

# ============================================
# JWT Authentication
# ============================================
JWT_SECRET=your-secure-random-secret-key-min-32-characters
JWT_EXPIRES_IN=15m                # Short-lived access token
REFRESH_TOKEN_EXPIRES_IN=30d      # Long-lived refresh token for "remember me"

# Generate a secure secret with:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# ============================================
# Stripe Checkout URLs
# ============================================
STRIPE_SUCCESS_URL=http://localhost:3000/success
STRIPE_CANCEL_URL=http://localhost:3000/cancel

# Optional: Pre-configured Stripe Price IDs (if using Stripe Products)
# STRIPE_TIER1_PRICE_ID=price_...
# STRIPE_TIER2_PRICE_ID=price_...
# STRIPE_TIER3_PRICE_ID=price_...
# STRIPE_TIER4_PRICE_ID=price_...

# ============================================
# File Storage Configuration
# ============================================
STORAGE_BUCKET=deliverables
MAX_FILE_SIZE_MB=50

# ============================================
# Docker Postgres (optional for local containers)
# ============================================
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=sage

# ============================================
# Frontend Configuration (kaa-app)
# ============================================
# Required for the React frontend to connect to the backend API
REACT_APP_API_URL=http://localhost:3001

# For production (Vercel monorepo deployment handles this automatically):
# REACT_APP_API_URL=https://your-domain.vercel.app

# ============================================
# OpenAI API Configuration (Required for Sage ChatGPT integration)
# ============================================
OPENAI_API_KEY=sk-your_openai_api_key_here

# Get your API key from: https://platform.openai.com/api-keys
# Note: Sage chat requires this to be set for intelligent conversations

# ============================================
# Setup Instructions
# ============================================
# 1. Copy this file: cp env.example .env
# 2. Fill in all required values above
# 3. For Supabase: Create project at https://app.supabase.com
# 4. For Stripe: Create account at https://dashboard.stripe.com
# 5. For Notion: Create integration at https://www.notion.so/my-integrations
# 6. Never commit .env to git (it's in .gitignore)
